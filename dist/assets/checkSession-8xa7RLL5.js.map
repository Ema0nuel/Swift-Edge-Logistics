{"version":3,"file":"checkSession-8xa7RLL5.js","sources":["../../src/script/views/User/function/checkSession.js"],"sourcesContent":["import { supabase } from '../../../utils/supabaseClient';\r\n\r\n/**\r\n * Checks if a user is logged in.\r\n * - On login/signup pages: If logged in, redirect to dashboard.\r\n * - On protected pages (like dashboard): If not logged in, redirect to login.\r\n * Pass `redirectIfLoggedIn` as true on login/signup pages.\r\n * Usage:\r\n *   // On login/signup:\r\n *   if (!(await checkSession(true))) return;\r\n *   // On dashboard/protected:\r\n *   if (!(await checkSession())) return;\r\n */\r\nexport async function checkSession(redirectIfLoggedIn = false) {\r\n  const { data: { session } } = await supabase.auth.getSession();\r\n\r\n  // If user is logged in and we're on login/signup, redirect to dashboard\r\n  if (redirectIfLoggedIn && session && session.user) {\r\n    window.location.href = \"/user/dashboard\";\r\n    return false;\r\n  }\r\n\r\n  // If user is NOT logged in and we're on a protected page, redirect to login\r\n  if (!redirectIfLoggedIn && (!session || !session.user)) {\r\n    window.location.href = \"/user/login\";\r\n    return false;\r\n  }\r\n\r\n  // Fetch user profile if logged in\r\n  if (session && session.user) {\r\n    const { data: profile, error: profileError } = await supabase\r\n      .from('profiles')\r\n      .select('*')\r\n      .eq('id', session.user.id)\r\n      .single();\r\n    if (profileError || !profile) {\r\n      window.location.href = \"/user/login\";\r\n      return false;\r\n    }\r\n    session.profile = profile;\r\n  }\r\n\r\n  return true;\r\n}"],"names":["checkSession","redirectIfLoggedIn","session","supabase","profile","profileError"],"mappings":"iDAaO,eAAeA,EAAaC,EAAqB,GAAO,CAC7D,KAAM,CAAE,KAAM,CAAE,QAAAC,CAAO,CAAE,EAAK,MAAMC,EAAS,KAAK,aAGlD,GAAIF,GAAsBC,GAAWA,EAAQ,KAC3C,cAAO,SAAS,KAAO,kBAChB,GAIT,GAAI,CAACD,IAAuB,CAACC,GAAW,CAACA,EAAQ,MAC/C,cAAO,SAAS,KAAO,cAChB,GAIT,GAAIA,GAAWA,EAAQ,KAAM,CAC3B,KAAM,CAAE,KAAME,EAAS,MAAOC,CAAY,EAAK,MAAMF,EAClD,KAAK,UAAU,EACf,OAAO,GAAG,EACV,GAAG,KAAMD,EAAQ,KAAK,EAAE,EACxB,SACH,GAAIG,GAAgB,CAACD,EACnB,cAAO,SAAS,KAAO,cAChB,GAETF,EAAQ,QAAUE,CACpB,CAEA,MAAO,EACT"}