{"version":3,"file":"users-Ct_n9O6A.js","sources":["../../src/script/views/Admin/users.js"],"sourcesContent":["import dayjs from \"dayjs\";\r\nimport { reset } from \"../../utils/reset.js\";\r\nimport { supabase } from \"../../utils/supabaseClient.js\";\r\nimport Navbar from \"./components/navbar.js\";\r\nimport toastr from '/src/script/utils/toastr.js';\r\n\r\n// --- Only for local testing! ---\r\nconst SUPABASE_SERVICE_ROLE_KEY = import.meta.env.VITE_SUPABASE_SERVICE_ROLE_KEY;\r\nconst SUPABASE_PROJECT_URL = \"https://pyslfvzwcmigrryoakpc.supabase.co\";\r\nasync function deleteSupabaseUser(user_id) {\r\n  const res = await fetch(`${SUPABASE_PROJECT_URL}/auth/v1/admin/users/${user_id}`, {\r\n    method: \"DELETE\",\r\n    headers: {\r\n      \"apikey\": SUPABASE_SERVICE_ROLE_KEY,\r\n      \"Authorization\": `Bearer ${SUPABASE_SERVICE_ROLE_KEY}`,\r\n      \"Content-Type\": \"application/json\"\r\n    }\r\n  });\r\n  return res.ok;\r\n}\r\n// --------------------------------\r\n\r\nconst defaultAvatar = \"/src/images/avatar-default.png\";\r\n\r\n// Utility: Show spinner overlay\r\nfunction showSpinner() {\r\n  const spinner = document.createElement(\"div\");\r\n  spinner.id = \"spinnerOverlay\";\r\n  spinner.innerHTML = `\r\n    <div class=\"fixed inset-0 bg-black/40 z-50 flex items-center justify-center\">\r\n      <div class=\"animate-spin rounded-full h-20 w-20 border-t-4 border-b-4 border-blue-500\"></div>\r\n    </div>\r\n  `;\r\n  document.body.appendChild(spinner);\r\n}\r\nfunction hideSpinner() {\r\n  document.getElementById(\"spinnerOverlay\")?.remove();\r\n}\r\n\r\n// Fetch all users\r\nasync function fetchUsers(search = \"\") {\r\n  let query = supabase\r\n    .from(\"profiles\")\r\n    .select(\"id, full_name, phone, role, avatar_url, created_at\")\r\n    .order(\"created_at\", { ascending: false });\r\n\r\n  if (search) {\r\n    query = query.ilike(\"full_name\", `%${search}%`);\r\n  }\r\n\r\n  const { data, error } = await query;\r\n  if (error) {\r\n    console.error(\"Error fetching users:\", error);\r\n    return [];\r\n  }\r\n  return data || [];\r\n}\r\n\r\n// Fetch user details, shipments, payments, logs\r\nasync function fetchUserDetails(userId) {\r\n  showSpinner();\r\n  const [{ data: profile }, { data: shipments }, { data: payments }, { data: logs }] = await Promise.all([\r\n    supabase.from(\"profiles\").select(\"*\").eq(\"id\", userId).single(),\r\n    supabase.from(\"shipments\").select(\"*\").eq(\"sender_id\", userId).order(\"created_at\", { ascending: false }),\r\n    supabase.from(\"payments\").select(\"*\").eq(\"user_id\", userId).order(\"created_at\", { ascending: false }),\r\n    supabase.from(\"admin_logs\").select(\"*\").eq(\"target_id\", userId).order(\"log_time\", { ascending: false }),\r\n  ]);\r\n  hideSpinner();\r\n  return { profile, shipments, payments, logs };\r\n}\r\n\r\n// Create user profile\r\nasync function createUserProfile(form) {\r\n  showSpinner();\r\n  const full_name = form.full_name.value.trim();\r\n  const email = form.email.value.trim();\r\n  const phone = form.phone.value.trim();\r\n  const password = form.password.value;\r\n  const role = form.role.value;\r\n\r\n  if (!full_name || !email || !phone || !password || !role) {\r\n    hideSpinner();\r\n    toastr.error(\"Please fill all fields.\");\r\n    return false;\r\n  }\r\n\r\n  // Create user using regular sign up (client-side)\r\n  const { data, error } = await supabase.auth.signUp({\r\n    email,\r\n    password,\r\n  });\r\n\r\n  if (error) {\r\n    hideSpinner();\r\n    toastr.error(error.message || \"Failed to create user.\");\r\n    return false;\r\n  }\r\n\r\n  const userId = data.user.id;\r\n\r\n  // Insert profile\r\n  const { error: profileError } = await supabase.from(\"profiles\").insert([\r\n    {\r\n      id: userId,\r\n      full_name,\r\n      phone,\r\n      role,\r\n      avatar_url: \"\",\r\n      email\r\n    },\r\n  ]);\r\n\r\n  hideSpinner();\r\n  if (profileError) {\r\n    toastr.error(profileError.message || \"Failed to create profile.\");\r\n    return false;\r\n  }\r\n\r\n  toastr.success(\"User created successfully!\");\r\n  return true;\r\n}\r\n\r\n// Edit user profile\r\nasync function editUserProfile(form, userId) {\r\n  showSpinner();\r\n  const full_name = form.full_name.value.trim();\r\n  const phone = form.phone.value.trim();\r\n  const role = form.role.value;\r\n\r\n  if (!full_name || !phone || !role) {\r\n    hideSpinner();\r\n    toastr.error(\"Please fill all fields.\");\r\n    return false;\r\n  }\r\n\r\n  const { error } = await supabase.from(\"profiles\").update({\r\n    full_name,\r\n    phone,\r\n    role,\r\n  }).eq(\"id\", userId);\r\n\r\n  hideSpinner();\r\n  if (error) {\r\n    toastr.error(error.message || \"Failed to update profile.\");\r\n    return false;\r\n  }\r\n\r\n  toastr.success(\"User updated successfully!\");\r\n  return true;\r\n}\r\n\r\n// Delete user (using service role key for admin API)\r\nasync function deleteUser(userId) {\r\n  if (!confirm(\"Are you sure you want to delete this user?\")) return false;\r\n  showSpinner();\r\n  try {\r\n    // Delete from Supabase Auth (admin API)\r\n    const ok = await deleteSupabaseUser(userId);\r\n    // Delete from profiles (cascade deletes other FK rows)\r\n    const { error: profileError } = await supabase.from(\"profiles\").delete().eq(\"id\", userId);\r\n    hideSpinner();\r\n    if (!ok || profileError) {\r\n      toastr.error((profileError?.message) || \"Failed to delete user.\");\r\n      return false;\r\n    }\r\n    toastr.success(\"User deleted successfully!\");\r\n    return true;\r\n  } catch (err) {\r\n    hideSpinner();\r\n    toastr.error(\"Failed to delete user: \" + err.message);\r\n    return false;\r\n  }\r\n}\r\n\r\nconst users = async () => {\r\n  reset(\"User Management\");\r\n  const { html: navbarHtml, pageEvents: navbarEvents } = Navbar();\r\n\r\n  let usersList = await fetchUsers();\r\n  let selectedUser = null;\r\n\r\n  // Render main view\r\n  function renderMain() {\r\n    const html = `\r\n      <div class=\"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 flex\">\r\n        ${navbarHtml}\r\n        <div class=\"flex-1 ml-0 sm:ml-64 h-screen overflow-y-auto transition-all duration-300\">\r\n          <main class=\"p-4 md:p-8 max-w-7xl mx-auto animate-fadeIn\">\r\n            <div class=\"flex items-center justify-between mb-8 animate-slideDown\">\r\n              <h1 class=\"text-3xl font-bold text-white\">üßë‚Äçüíº User Management</h1>\r\n              <button id=\"createUserBtn\" class=\"px-4 py-2 rounded bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold shadow-lg hover:scale-105 transition-all\">\r\n                <i class=\"fa fa-user-plus\"></i> Create User\r\n              </button>\r\n            </div>\r\n            <div class=\"mb-6\">\r\n              <input type=\"text\" id=\"searchInput\" class=\"input input-bordered w-full max-w-xs py-2 px-4 rounded-lg focus:ring-2 focus:ring-blue-500 transition-all\" placeholder=\"Search users by name...\" />\r\n            </div>\r\n            <div class=\"overflow-x-auto\">\r\n              <table class=\"min-w-full bg-white/10 rounded-xl border border-white/20 text-white shadow-lg\">\r\n                <thead>\r\n                  <tr>\r\n                    <th class=\"px-4 py-2\">Avatar</th>\r\n                    <th class=\"px-4 py-2\">Name</th>\r\n                    <th class=\"px-4 py-2\">Phone</th>\r\n                    <th class=\"px-4 py-2\">Role</th>\r\n                    <th class=\"px-4 py-2\">Joined</th>\r\n                    <th class=\"px-4 py-2\">Actions</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody id=\"usersTableBody\">\r\n                  ${usersList.map(user => `\r\n                    <tr class=\"hover:bg-white/20 transition-all cursor-pointer\" data-user-id=\"${user.id}\">\r\n                      <td class=\"px-4 py-2\"><img src=\"${user.avatar_url || defaultAvatar}\" class=\"w-10 h-10 rounded-full border-2 border-blue-500 bg-white\" /></td>\r\n                      <td class=\"px-4 py-2 font-bold\">${user.full_name}</td>\r\n                      <td class=\"px-4 py-2\">${user.phone}</td>\r\n                      <td class=\"px-4 py-2\">\r\n                        <span class=\"px-2 py-1 rounded-full text-xs font-medium ${user.role === \"admin\" ? \"bg-purple-500/20 text-purple-400\" : \"bg-blue-500/20 text-blue-400\"}\">\r\n                          ${user.role}\r\n                        </span>\r\n                      </td>\r\n                      <td class=\"px-4 py-2\">${dayjs(user.created_at).format(\"MMM D, YYYY\")}</td>\r\n                      <td class=\"px-4 py-2\">\r\n                        <button class=\"detailsUserBtn px-2 py-1 rounded bg-blue-600 text-white mr-2 transition-all hover:bg-blue-700\" title=\"Details\"><i class=\"fa fa-eye\"></i></button>\r\n                        <button class=\"editUserBtn px-2 py-1 rounded bg-yellow-600 text-white mr-2 transition-all hover:bg-yellow-700\" title=\"Edit\"><i class=\"fa fa-edit\"></i></button>\r\n                        <button class=\"deleteUserBtn px-2 py-1 rounded bg-red-600 text-white transition-all hover:bg-red-700\" title=\"Delete\"><i class=\"fa fa-trash\"></i></button>\r\n                      </td>\r\n                    </tr>\r\n                  `).join(\"\")}\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n            <div id=\"createUserModal\" class=\"fixed inset-0 bg-black/60 hidden items-center justify-center z-50 flex\">\r\n              <div class=\"bg-white rounded-xl p-8 w-full max-w-md shadow-lg relative animate-slideIn\">\r\n                <button id=\"closeModalBtn\" class=\"absolute top-4 right-4 text-gray-500 hover:text-red-500 text-xl\"><i class=\"fa fa-times\"></i></button>\r\n                <h2 class=\"text-2xl font-bold mb-4 text-gray-800\">Create New User</h2>\r\n                <form id=\"createUserForm\" class=\"space-y-4\">\r\n                  <input type=\"text\" name=\"full_name\" placeholder=\"Full Name\" class=\"input input-bordered w-full py-2 px-4 rounded-lg\" required />\r\n                  <input type=\"email\" name=\"email\" placeholder=\"Email\" class=\"input input-bordered w-full py-2 px-4 rounded-lg\" required />\r\n                  <input type=\"tel\" name=\"phone\" placeholder=\"Phone\" class=\"input input-bordered w-full py-2 px-4 rounded-lg\" required />\r\n                  <input type=\"password\" name=\"password\" placeholder=\"Password\" class=\"input input-bordered w-full py-2 px-4 rounded-lg\" required />\r\n                  <select name=\"role\" class=\"input input-bordered w-full py-2 px-4 rounded-lg\" required>\r\n                    <option value=\"user\">User</option>\r\n                    <option value=\"admin\">Admin</option>\r\n                  </select>\r\n                  <button type=\"submit\" class=\"btn btn-primary w-full py-2 font-bold bg-gradient-to-r from-blue-600 to-indigo-600 text-white\">Create User</button>\r\n                </form>\r\n              </div>\r\n            </div>\r\n          </main>\r\n        </div>\r\n      </div>\r\n      <style>\r\n        #admin-sidebar { position: fixed; left: 0; top: 0; height: 100vh; }\r\n        @media (max-width: 640px) {\r\n          #admin-sidebar { width: 100vw; }\r\n          .sm\\\\:ml-64, .ml-64 { margin-left: 0 !important; }\r\n        }\r\n        .animate-slideIn { animation: slideIn 0.4s cubic-bezier(.4,0,.2,1); }\r\n        @keyframes slideIn {\r\n          from { transform: translateY(40px); opacity: 0; }\r\n          to { transform: translateY(0); opacity: 1; }\r\n        }\r\n      </style>\r\n    `;\r\n    document.querySelector(\"#app\").innerHTML = html;\r\n    mainEvents();\r\n  }\r\n\r\n  // Render user details view\r\n  async function renderUserDetails(userId) {\r\n    selectedUser = userId;\r\n    showSpinner();\r\n    const { profile, shipments, payments, logs } = await fetchUserDetails(userId);\r\n    hideSpinner();\r\n    const html = `\r\n      <div class=\"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 flex\">\r\n        ${navbarHtml}\r\n        <div class=\"flex-1 ml-0 sm:ml-64 h-screen overflow-y-auto transition-all duration-300\">\r\n          <main class=\"p-4 md:p-8 max-w-5xl mx-auto animate-fadeIn\">\r\n            <button id=\"backToUsers\" class=\"mb-6 px-4 py-2 rounded bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold shadow hover:scale-105 transition-all\">\r\n              <i class=\"fa fa-arrow-left\"></i> Back to Users\r\n            </button>\r\n            <div class=\"flex items-center gap-6 mb-8\">\r\n              <img src=\"${profile.avatar_url || defaultAvatar}\" class=\"w-20 h-20 rounded-full border-4 border-blue-500 bg-white\" alt=\"Avatar\" />\r\n              <div>\r\n                <h2 class=\"text-2xl font-bold text-white\">${profile.full_name}</h2>\r\n                <p class=\"text-blue-300\">${profile.email || \"\"}</p>\r\n                <p class=\"text-gray-400\">Phone: ${profile.phone}</p>\r\n                <span class=\"px-3 py-1 rounded-full text-xs font-medium ${profile.role === \"admin\" ? \"bg-purple-500/20 text-purple-400\" : \"bg-blue-500/20 text-blue-400\"}\">\r\n                  ${profile.role}\r\n                </span>\r\n                <span class=\"ml-2 text-xs text-gray-400\">Joined: ${dayjs(profile.created_at).format(\"MMM D, YYYY\")}</span>\r\n              </div>\r\n            </div>\r\n            <div class=\"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8\">\r\n              <div class=\"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20\">\r\n                <h3 class=\"text-lg font-bold text-white mb-4\">Shipments</h3>\r\n                <div class=\"space-y-2\">\r\n                  ${shipments.length ? shipments.map(s => `\r\n                    <div class=\"p-3 rounded bg-white/5 text-white flex justify-between items-center\">\r\n                      <span>${s.tracking_code}</span>\r\n                      <span class=\"text-blue-400\">${s.status}</span>\r\n                    </div>\r\n                  `).join(\"\") : \"<div class='text-gray-400'>No shipments.</div>\"}\r\n                </div>\r\n              </div>\r\n              <div class=\"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20\">\r\n                <h3 class=\"text-lg font-bold text-white mb-4\">Payments</h3>\r\n                <div class=\"space-y-2\">\r\n                  ${payments.length ? payments.map(p => `\r\n                    <div class=\"p-3 rounded bg-white/5 text-white flex justify-between items-center\">\r\n                      <span>${p.method || \"Card\"} - ${p.amount}</span>\r\n                      <span class=\"text-blue-400\">${p.status}</span>\r\n                    </div>\r\n                  `).join(\"\") : \"<div class='text-gray-400'>No payments.</div>\"}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div class=\"bg-white/10 backdrop-blur-md rounded-xl p-6 border border-white/20 mb-8\">\r\n              <h3 class=\"text-lg font-bold text-white mb-4\">Activity Logs</h3>\r\n              <div class=\"space-y-2\">\r\n                ${logs.length ? logs.map(l => `\r\n                  <div class=\"p-3 rounded bg-white/5 text-white flex justify-between items-center\">\r\n                    <span>${l.action}</span>\r\n                    <span class=\"text-gray-400\">${dayjs(l.log_time).format(\"MMM D, YYYY HH:mm\")}</span>\r\n                  </div>\r\n                `).join(\"\") : \"<div class='text-gray-400'>No logs.</div>\"}\r\n              </div>\r\n            </div>\r\n            <button id=\"editUserBtnDetails\" class=\"px-4 py-2 rounded bg-yellow-600 text-white font-bold shadow hover:bg-yellow-700 transition-all mr-2\">\r\n              <i class=\"fa fa-edit\"></i> Edit User\r\n            </button>\r\n            <button id=\"deleteUserBtnDetails\" class=\"px-4 py-2 rounded bg-red-600 text-white font-bold shadow hover:bg-red-700 transition-all\">\r\n              <i class=\"fa fa-trash\"></i> Delete User\r\n            </button>\r\n          </main>\r\n        </div>\r\n      </div>\r\n      <style>\r\n        #admin-sidebar { position: fixed; left: 0; top: 0; height: 100vh; }\r\n        @media (max-width: 640px) {\r\n          #admin-sidebar { width: 100vw; }\r\n          .sm\\\\:ml-64, .ml-64 { margin-left: 0 !important; }\r\n        }\r\n      </style>\r\n    `;\r\n    document.querySelector(\"#app\").innerHTML = html;\r\n    detailsEvents(profile.id);\r\n  }\r\n\r\n  // Render edit user form\r\n  async function renderEditUser(userId) {\r\n    showSpinner();\r\n    const { profile } = await fetchUserDetails(userId);\r\n    hideSpinner();\r\n    const html = `\r\n      <div class=\"min-h-screen bg-gradient-to-br from-gray-900 via-blue-900 to-indigo-900 flex\">\r\n        ${navbarHtml}\r\n        <div class=\"flex-1 ml-0 sm:ml-64 h-screen overflow-y-auto transition-all duration-300\">\r\n          <main class=\"p-4 md:p-8 max-w-md mx-auto animate-fadeIn\">\r\n            <button id=\"backToDetails\" class=\"mb-6 px-4 py-2 rounded bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold shadow hover:scale-105 transition-all\">\r\n              <i class=\"fa fa-arrow-left\"></i> Back to Details\r\n            </button>\r\n            <h2 class=\"text-2xl font-bold mb-4 text-white\">Edit User</h2>\r\n            <form id=\"editUserForm\" class=\"space-y-4\">\r\n              <input type=\"text\" name=\"full_name\" value=\"${profile.full_name}\" placeholder=\"Full Name\" class=\"input input-bordered w-full py-2 px-4 rounded-lg\" required />\r\n              <input type=\"tel\" name=\"phone\" value=\"${profile.phone}\" placeholder=\"Phone\" class=\"input input-bordered w-full py-2 px-4 rounded-lg\" required />\r\n              <select name=\"role\" class=\"input input-bordered w-full py-2 px-4 rounded-lg\" required>\r\n                <option value=\"user\" ${profile.role === \"user\" ? \"selected\" : \"\"}>User</option>\r\n                <option value=\"admin\" ${profile.role === \"admin\" ? \"selected\" : \"\"}>Admin</option>\r\n              </select>\r\n              <button type=\"submit\" class=\"btn btn-primary w-full py-2 font-bold bg-gradient-to-r from-yellow-500 to-yellow-700 text-white\">Update User</button>\r\n            </form>\r\n          </main>\r\n        </div>\r\n      </div>\r\n      <style>\r\n        #admin-sidebar { position: fixed; left: 0; top: 0; height: 100vh; }\r\n        @media (max-width: 640px) {\r\n          #admin-sidebar { width: 100vw; }\r\n          .sm\\\\:ml-64, .ml-64 { margin-left: 0 !important; }\r\n        }\r\n      </style>\r\n    `;\r\n    document.querySelector(\"#app\").innerHTML = html;\r\n    editEvents(profile.id);\r\n  }\r\n\r\n  // Main table events\r\n  function mainEvents() {\r\n    navbarEvents();\r\n\r\n    // Search/filter users\r\n    document.getElementById(\"searchInput\")?.addEventListener(\"input\", async (e) => {\r\n      showSpinner();\r\n      const search = e.target.value.trim();\r\n      usersList = await fetchUsers(search);\r\n      hideSpinner();\r\n      renderMain();\r\n    });\r\n\r\n    // Row actions\r\n    document.querySelectorAll(\"#usersTableBody tr\").forEach(row => {\r\n      const userId = row.getAttribute(\"data-user-id\");\r\n      row.querySelector(\".detailsUserBtn\")?.addEventListener(\"click\", (e) => {\r\n        e.stopPropagation();\r\n        renderUserDetails(userId);\r\n      });\r\n      row.querySelector(\".editUserBtn\")?.addEventListener(\"click\", (e) => {\r\n        e.stopPropagation();\r\n        renderEditUser(userId);\r\n      });\r\n      row.querySelector(\".deleteUserBtn\")?.addEventListener(\"click\", async (e) => {\r\n        e.stopPropagation();\r\n        const success = await deleteUser(userId);\r\n        if (success) {\r\n          usersList = await fetchUsers();\r\n          renderMain();\r\n        }\r\n      });\r\n    });\r\n\r\n    // Modal logic\r\n    const modal = document.getElementById(\"createUserModal\");\r\n    document.getElementById(\"createUserBtn\")?.addEventListener(\"click\", () => {\r\n      modal.classList.remove(\"hidden\");\r\n    });\r\n    document.getElementById(\"closeModalBtn\")?.addEventListener(\"click\", () => {\r\n      modal.classList.add(\"hidden\");\r\n    });\r\n\r\n    // Create user form\r\n    document.getElementById(\"createUserForm\")?.addEventListener(\"submit\", async (e) => {\r\n      e.preventDefault();\r\n      const form = e.target;\r\n      const success = await createUserProfile(form);\r\n      if (success) {\r\n        modal.classList.add(\"hidden\");\r\n        usersList = await fetchUsers();\r\n        renderMain();\r\n      }\r\n    });\r\n  }\r\n\r\n  // Details view events\r\n  function detailsEvents(userId) {\r\n    navbarEvents();\r\n    document.getElementById(\"backToUsers\")?.addEventListener(\"click\", () => {\r\n      selectedUser = null;\r\n      renderMain();\r\n    });\r\n    document.getElementById(\"editUserBtnDetails\")?.addEventListener(\"click\", () => {\r\n      renderEditUser(userId);\r\n    });\r\n    document.getElementById(\"deleteUserBtnDetails\")?.addEventListener(\"click\", async () => {\r\n      const success = await deleteUser(userId);\r\n      if (success) {\r\n        selectedUser = null;\r\n        usersList = await fetchUsers();\r\n        renderMain();\r\n      }\r\n    });\r\n  }\r\n\r\n  // Edit view events\r\n  function editEvents(userId) {\r\n    navbarEvents();\r\n    document.getElementById(\"backToDetails\")?.addEventListener(\"click\", () => {\r\n      renderUserDetails(userId);\r\n    });\r\n    document.getElementById(\"editUserForm\")?.addEventListener(\"submit\", async (e) => {\r\n      e.preventDefault();\r\n      const form = e.target;\r\n      const success = await editUserProfile(form, userId);\r\n      if (success) {\r\n        renderUserDetails(userId);\r\n      }\r\n    });\r\n  }\r\n\r\n  // Return dummy for router compatibility\r\n  return {\r\n    html: \"\",\r\n    pageEvents: () => {\r\n      // Initial render\r\n      renderMain();\r\n    }\r\n  };\r\n};\r\n\r\nexport default users;"],"names":["SUPABASE_SERVICE_ROLE_KEY","SUPABASE_PROJECT_URL","deleteSupabaseUser","user_id","defaultAvatar","showSpinner","spinner","hideSpinner","fetchUsers","search","query","supabase","data","error","fetchUserDetails","userId","profile","shipments","payments","logs","createUserProfile","form","full_name","email","phone","password","role","toastr","profileError","editUserProfile","deleteUser","ok","err","users","reset","navbarHtml","navbarEvents","Navbar","usersList","renderMain","html","user","dayjs","mainEvents","renderUserDetails","s","p","l","detailsEvents","renderEditUser","editEvents","row","e","modal"],"mappings":"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"}