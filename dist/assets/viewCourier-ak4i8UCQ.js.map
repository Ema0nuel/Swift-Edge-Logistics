{"version":3,"file":"viewCourier-ak4i8UCQ.js","sources":["../../src/script/views/User/viewCourier.js"],"sourcesContent":["import Navbar from \"./components/navbar\";\r\nimport { supabase } from \"../../utils/supabaseClient\";\r\nimport { reset } from \"../../utils/reset\";\r\n\r\n// Get current user from Supabase Auth (like dashboard.js)\r\nasync function getCurrentUserId() {\r\n  const { data, error } = await supabase.auth.getUser();\r\n  if (error || !data?.user?.id) return null;\r\n  return data.user.id;\r\n}\r\n\r\nconst viewCourier = async () => {\r\n  reset(\"View Courier Products\");\r\n  const { html: navbarHtml, pageEvents: navbarEvents } = Navbar(\"view-courier\");\r\n\r\n  // Get logged-in user's id\r\n  const userId = await getCurrentUserId();\r\n\r\n  let productsHtml = \"\";\r\n  if (!userId) {\r\n    productsHtml = `<div class=\"text-center text-gray-600 mt-8\">You must be logged in to view your shipments.</div>`;\r\n  } else {\r\n    // Fetch only this user's shipments using sender_id\r\n    const { data: shipments } = await supabase\r\n      .from(\"shipments\")\r\n      .select(\"*\")\r\n      .eq(\"sender_id\", userId)\r\n      .in(\"status\", [\"in-transit\", \"delivered\", \"processing\"])\r\n      .order(\"created_at\", { ascending: false });\r\n\r\n    if (!shipments || shipments.length === 0) {\r\n      productsHtml = `<p class=\"text-center text-gray-600 mt-8\">No products currently in transit.</p>`;\r\n    } else {\r\n      productsHtml = shipments.map((product) => {\r\n        let statusColorClass;\r\n        if (product.status === \"delivered\") {\r\n          statusColorClass = \"bg-green-200 text-green-800\";\r\n        } else if (product.status === \"in-transit\") {\r\n          statusColorClass = \"bg-blue-200 text-blue-800\";\r\n        } else {\r\n          statusColorClass = \"bg-yellow-200 text-yellow-800\";\r\n        }\r\n        return `\r\n          <div class=\"bg-gray-50 p-6 rounded-lg shadow-md hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 pb-16 relative\">\r\n            <h3 class=\"text-xl font-semibold text-gray-800 mb-2\">${product.receiver_name}</h3>\r\n            <p class=\"text-sm text-gray-600 mb-3\">Tracking ID: <span class=\"font-mono\">${product.tracking_code}</span></p>\r\n            <div class=\"flex items-center mb-2\">\r\n              <span class=\"px-3 py-1 rounded-full text-xs font-semibold ${statusColorClass}\">\r\n                ${product.status.charAt(0).toUpperCase() + product.status.slice(1)}\r\n              </span>\r\n            </div>\r\n            <p class=\"text-gray-700\"><strong>Origin:</strong> ${product.origin}</p>\r\n            <p class=\"text-gray-700\"><strong>Destination:</strong> ${product.destination}</p>\r\n            <p class=\"text-gray-700\"><strong>Receiver:</strong> ${product.receiver_name} (${product.receiver_phone})</p>\r\n            <p class=\"text-gray-700\"><strong>ETA:</strong> ${product.delivery_datetime ? new Date(product.delivery_datetime).toLocaleString() : \"N/A\"}</p>\r\n          </div>\r\n        `;\r\n      }).join(\"\");\r\n    }\r\n  }\r\n\r\n  const html = `\r\n    <div class=\"min-h-screen bg-[#1e293b]\">\r\n      ${navbarHtml}\r\n      <main class=\"container mx-auto px-4 py-8 max-w-5xl\">\r\n        <h2 class=\"text-3xl font-bold text-indigo-700 mb-6 text-center\">Products in Transit</h2>\r\n        <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n          ${productsHtml}\r\n        </div>\r\n      </main>\r\n    </div>\r\n  `;\r\n\r\n  function pageEvents() {\r\n    navbarEvents();\r\n  }\r\n\r\n  return { html, pageEvents };\r\n};\r\n\r\nexport default viewCourier;"],"names":["getCurrentUserId","data","error","supabase","viewCourier","reset","navbarHtml","navbarEvents","Navbar","userId","productsHtml","shipments","product","statusColorClass","html","pageEvents"],"mappings":"0PAKA,eAAeA,GAAmB,CAChC,KAAM,CAAE,KAAAC,EAAM,MAAAC,CAAK,EAAK,MAAMC,EAAS,KAAK,UAC5C,OAAID,GAAS,CAACD,GAAM,MAAM,GAAW,KAC9BA,EAAK,KAAK,EACnB,CAEK,MAACG,EAAc,SAAY,CAC9BC,EAAM,uBAAuB,EAC7B,KAAM,CAAE,KAAMC,EAAY,WAAYC,GAAiBC,EAAO,cAAc,EAGtEC,EAAS,MAAMT,IAErB,IAAIU,EAAe,GACnB,GAAI,CAACD,EACHC,EAAe,sGACV,CAEL,KAAM,CAAE,KAAMC,CAAS,EAAK,MAAMR,EAC/B,KAAK,WAAW,EAChB,OAAO,GAAG,EACV,GAAG,YAAaM,CAAM,EACtB,GAAG,SAAU,CAAC,aAAc,YAAa,YAAY,CAAC,EACtD,MAAM,aAAc,CAAE,UAAW,EAAK,CAAE,EAEvC,CAACE,GAAaA,EAAU,SAAW,EACrCD,EAAe,kFAEfA,EAAeC,EAAU,IAAKC,GAAY,CACxC,IAAIC,EACJ,OAAID,EAAQ,SAAW,YACrBC,EAAmB,8BACVD,EAAQ,SAAW,aAC5BC,EAAmB,4BAEnBA,EAAmB,gCAEd;AAAA;AAAA,mEAEoDD,EAAQ,aAAa;AAAA,yFACCA,EAAQ,aAAa;AAAA;AAAA,0EAEpCC,CAAgB;AAAA,kBACxED,EAAQ,OAAO,OAAO,CAAC,EAAE,YAAW,EAAKA,EAAQ,OAAO,MAAM,CAAC,CAAC;AAAA;AAAA;AAAA,gEAGlBA,EAAQ,MAAM;AAAA,qEACTA,EAAQ,WAAW;AAAA,kEACtBA,EAAQ,aAAa,KAAKA,EAAQ,cAAc;AAAA,6DACrDA,EAAQ,kBAAoB,IAAI,KAAKA,EAAQ,iBAAiB,EAAE,eAAc,EAAK,KAAK;AAAA;AAAA,SAG/I,CAAC,EAAE,KAAK,EAAE,CAEd,CAEA,MAAME,EAAO;AAAA;AAAA,QAEPR,CAAU;AAAA;AAAA;AAAA;AAAA,YAINI,CAAY;AAAA;AAAA;AAAA;AAAA,IAMtB,SAASK,GAAa,CACpBR,GACF,CAEA,MAAO,CAAE,KAAAO,EAAM,WAAAC,EACjB"}